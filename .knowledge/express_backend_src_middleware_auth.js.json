{"is_source_file": true, "format": "JavaScript", "description": "This file defines Express middleware functions for authentication and authorization using JSON Web Tokens (JWT). It includes functions to extract tokens from request headers, verify tokens, and enforce role-based access control, specifically requiring admin role in some cases.", "external_files": ["jsonwebtoken"], "external_methods": ["jwt.verify"], "published": ["requireAuth", "requireAdmin"], "classes": [], "methods": [{"name": "extractToken(req)", "description": "Extracts JWT token from the 'Authorization' header in the HTTP request. Expects header format: 'Bearer <token>'.", "scope": "", "scopeKind": ""}, {"name": "requireAuth(req, res, next)", "description": "Express middleware to verify presence of a valid JWT token, decode it, and attach user information to the request object.", "scope": "", "scopeKind": ""}, {"name": "requireAdmin(req, res, next)", "description": "Express middleware to ensure the authenticated user has 'admin' role, otherwise responds with an error.", "scope": "", "scopeKind": ""}], "calls": ["jwt.verify", "req.get"], "search-terms": ["JWT middleware", "authorization", "auth token extraction", "require admin role", "Express auth middleware"], "state": 2, "file_id": 20, "knowledge_revision": 51, "git_revision": "", "ctags": [{"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^      email: payload.email,$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "extractToken", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^function extractToken(req) {$/", "language": "JavaScript", "kind": "function", "signature": "(req)"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^      id: payload.sub,$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "jwt", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^const jwt = require('jsonwebtoken');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "requireAdmin", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^function requireAdmin(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "requireAuth", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^  requireAuth,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "requireAuth", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^function requireAuth(req, res, next) {$/", "language": "JavaScript", "kind": "function", "signature": "(req, res, next)"}, {"_type": "tag", "name": "roles", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^      roles: Array.isArray(payload.roles) ? payload.roles : [],$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^    req.user = {$/", "language": "JavaScript", "kind": "class", "scope": "req", "scopeKind": "class"}, {"_type": "tag", "name": "username", "path": "/home/kavia/workspace/code-generation/real-time-analytics-dashboard-182952-182961/express_backend/src/middleware/auth.js", "pattern": "/^      username: payload.username,$/", "language": "JavaScript", "kind": "property", "scope": "req.user", "scopeKind": "class"}], "hash": "fb4e87abf4a7a73c04fd7e298c29741e", "format-version": 4, "code-base-name": "express_backend", "filename": "express_backend/src/middleware/auth.js", "fields": [{"name": "email: payload.email,", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}, {"name": "id: payload.sub,", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}, {"name": "requireAuth,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "roles: Array.isArray(payload.roles) ? payload.roles : [],", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}, {"name": "username: payload.username,", "scope": "req.user", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"51": ""}]}